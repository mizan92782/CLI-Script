#!/bin/bash
show_help() {
    echo ""
    echo "================ Django CLI Helper ================"
    echo "Usage: djn [command] [name]"
    echo ""
    echo "Available Commands:"
    echo "  env                   Activate virtual environment"
    echo "                        Command: source venv/bin/activate"
    echo ""
    echo "  project [name]        Create a new Django project"
    echo "                        Command: django-admin startproject [name]"
    echo ""
    echo "  app [name]            Create a new Django app"
    echo "                        Command: python manage.py startapp [name]"
    echo ""
    echo "  migration             Run makemigrations & migrate"
    echo "                        Command: python manage.py makemigrations && python manage.py migrate"
    echo ""
    echo "  runserver             Start Django development server"
    echo "                        Command: python manage.py runserver"
    echo ""
    echo "  superuser             Create Django superuser"
    echo "                        Command: python manage.py createsuperuser"
    echo ""
    echo "  static                Collect static files"
    echo "                        Command: python manage.py collectstatic"
    echo ""
    echo "  showmig               Show migrations"
    echo "                        Command: python manage.py showmigrations"
    echo ""
    echo "  shell                 Open Django shell"
    echo "                        Command: python manage.py shell"
    echo ""
    echo "  rs [script_name]      Run custom Django script"
    echo "                        Command: python manage.py runscript [script_name]"
    echo ""
    echo "  help [command]        Show detailed help for a command"
    echo "                        Command: djn help [command]"
    echo ""
    echo "  --help                Show this help message"
    echo ""
    echo "==================================================="
    echo ""
}



#show main help menu
if [[ $1 == "--help" || $1 == "-h" ]]; then
    show_help
    exit 0
fi





# Ensure at least one argument exists
if [ -z "$1" ]; then
    echo "Error: No command provided. Use --help for usage information."
    exit 1
fi




option=$1
arg2=$2

# Use python from venv if active
PYTHON=python3




case $option in

  
    project)
        if [ -z "$arg2" ]; then
            echo "Error: Project name required!"
            exit 1
        fi
        echo "Creating Django project '$arg2'..."
        $PYTHON -m django startproject "$arg2"
        cd "$arg2" || exit
        echo "Project '$arg2' created! ================================="
        ;;

    app)
        if [ -z "$arg2" ]; then
            echo "Error: App name required!"
            exit 1
        fi
        echo "Creating Django app '$arg2'..."
        $PYTHON manage.py startapp "$arg2"
        echo "App '$arg2' created! ======================================="
        ;;

    migration)
        echo "Running makemigrations ======================================"
        $PYTHON manage.py makemigrations
        echo "Running migrate..."
        $PYTHON manage.py migrate
        ;;

    runserver)
        echo "Starting Django development server ==========================="
        $PYTHON manage.py runserver
        ;;

    superuser)
        echo "Creating Django superuser ===================================="
        $PYTHON manage.py createsuperuser
        ;;

    static)
        echo "Collecting static files ======================================"
        $PYTHON manage.py collectstatic
        ;;

    showmig)
        echo "Showing migrations ==========================================="
        $PYTHON manage.py showmigrations
        ;;

    shell)
        echo "Opening Django shell ========================================="
        $PYTHON manage.py shell
        ;;

    rs)
        if [ -z "$arg2" ]; then
            echo "Error: Script name required!"
            exit 1
        fi
        echo "Running Django custom script: $arg2 =========================="
        $PYTHON manage.py runscript "$arg2"
        ;;

    *)
        echo "Invalid command! Use --help for available options."
        ;;
esac

exit 0

